<html>
  <head>
    <title>钉钉智登 - 池心砚</title>
  </head>
  <script>
function getQueryParam(url) {
var queryString = url.split('?')[1];
if (!queryString) {
return;
}
return queryString;
}

function encodeQueryParam(queryString) {
return encodeURIComponent(queryString);
}

function checkUserAgent(userAgent) {
if (userAgent.includes('com.laiwang.DingTalk')) {
return 'auth';
} else {
return 'login';
}
}

var url = window.location.href;
var query = getQueryParam(url);

if (!query) {
document.getElementByTagName('h1')[0].innerHTML = "❌ - 参数错误，网页无法运行";
} else {
if (encodeQueryParam(query)) {
var goto = encodeQueryParam(query);
} else {
var goto = query;
}

var sns = checkUserAgent(navigator.userAgent);

window.location.href = "https://oapi.dingtalk.com/connect/oauth2/sns_authorize?appid=ding5o1l1vxa2vrtesoe&redirect_uri=" + goto + "&response_type=code&scope=snsapi_" + sns
  </script>
  <body>
      <center><h1>钉钉智登 - 池心砚</h1></center>
      <center><a href="dingtalk://dingtalkclient/page/link?url=https%3A%2F%2Fh5.dingtalk.com%2Fzproject%2Fprofile.html%3Ffr_source%3D13%26profile%3D%2540kgDOC1rsiw%26cardToken%3D366cf67b58&pc_slide=true">添加我的钉钉账号</a></center>
  </body>
</html>
